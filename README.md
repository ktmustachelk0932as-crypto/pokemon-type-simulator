# ポケモンタイプ相性シミュレーター

ポケモンのタイプ相性を計算・表示するWebアプリケーションです。相手ポケモンのタイプを選択すると、全18タイプのわざがどれだけ効果的かを視覚的に確認できます。

## 機能

- **ポケモン名検索**: ポケモン名を入力すると、APIから候補を取得してタイプを自動設定
  - ひらがな・カタカナ両対応（例: 「かいろー」でも「カイリュー」を検索可能）
  - 前方一致を優先し、最大10件の候補を表示
- **タイプ手動選択**: 18種類のタイプから最大2つまで選択可能
- **相性計算**: 選択したタイプに対する全18タイプのわざの効果倍率を自動計算
- **カテゴリ別表示**: 効果倍率ごとにアコーディオンで分類表示
  - 効果はちょうバツグンだ! (×4.0)
  - 効果はバツグンだ! (×2.0)
  - 等倍 (×1.0)
  - 効果はいまひとつだ (×0.5)
  - 効果はかなりいまひとつだ (×0.25)
  - 効果がないようだ… (無効)

## 技術スタック

- **フレームワーク**: Next.js 16.0.10 (App Router)
- **言語**: TypeScript
- **UI**: React 19.2.0
- **スタイリング**: Tailwind CSS 4.1.9
- **UIコンポーネント**: Radix UI
- **データ取得**: PokeAPI

## セットアップ

### 必要な環境

- Node.js 18以上
- npm または pnpm

### インストール

```bash
# 依存関係のインストール
npm install
# または
pnpm install
```

### ポケモンデータの取得

アプリケーションを使用する前に、PokeAPIからポケモンデータを取得する必要があります。

```bash
npm run fetch-pokemon
```

このコマンドは、PokeAPIから最新のポケモンデータを取得し、`src/data/pokemon.json`に保存します。

**機能**:
- **動的総数取得**: PokeAPIから最新のポケモン総数を自動取得
- **差分取得**: 既存データがある場合、新しいポケモンのみを取得（2回目以降の実行が高速化）
- **既存データ確認**: 既存データが最新の場合は取得をスキップ

**注意**: 各APIリクエストの間に0.1秒の待機時間を設けているため、APIサーバーへの負荷を軽減しています。初回実行時は数分かかる場合があります（約3-4分程度）。2回目以降は差分のみ取得するため、大幅に短縮されます。

### 開発サーバーの起動

```bash
npm run dev
```

ブラウザで [http://localhost:3000](http://localhost:3000) を開いてアプリケーションを確認できます。

## プロジェクト構造

```
pokemon-type-simulator/
├── app/
│   ├── api/
│   │   └── pokemon/
│   │       └── route.ts          # ポケモン検索API
│   ├── layout.tsx                # ルートレイアウト
│   ├── page.tsx                  # メインページ
│   └── globals.css               # グローバルスタイル
├── components/
│   └── ui/                       # UIコンポーネント
├── src/
│   ├── app/
│   │   └── api/
│   │       └── pokemon/
│   │           └── route.ts      # APIルート（旧）
│   └── data/
│       ├── fetch-pokemon.mjs     # ポケモンデータ取得スクリプト
│       └── pokemon.json          # ポケモンデータ（生成される）
├── package.json
└── tsconfig.json
```

## 使用方法

1. **ポケモン名で検索**
   - 検索窓にポケモン名を入力（例: 「カイリュー」または「かいりー」）
   - ひらがな・カタカナどちらでも検索可能
   - 候補から選択すると、そのポケモンのタイプが自動的に設定されます
   - 前方一致の候補が優先表示され、最大10件まで表示されます

2. **タイプを手動選択**
   - 「相手のタイプ」セクションから、最大2つまでタイプを選択
   - 選択されたタイプはリングで強調表示されます

3. **相性を確認**
   - 「わざのタイプ別効果倍率」セクションで、各カテゴリを展開して確認
   - 効果倍率ごとにタイプが分類表示されます

## 利用可能なスクリプト

- `npm run dev` - 開発サーバーを起動
- `npm run build` - 本番用ビルドを作成
- `npm run start` - 本番サーバーを起動
- `npm run lint` - ESLintでコードをチェック
- `npm run fetch-pokemon` - PokeAPIからポケモンデータを取得

## タイプ相性の計算ロジック

- 単一タイプの場合: そのタイプに対する相性倍率をそのまま使用
- 複数タイプの場合: 各タイプに対する相性倍率を乗算
  - 例: ほのお×くさタイプに対して、みずわざは 2.0 × 0.5 = 1.0（等倍）

## 検索機能の詳細

### ポケモン名検索

- **ひらがな・カタカナ対応**: 入力された文字列を自動的にカタカナに正規化して検索します
  - 例: 「かいり」→「カイリュー」を検索
  - 例: 「ぴか」→「ピカチュウ」を検索
- **検索アルゴリズム**:
  1. 前方一致の候補を優先表示
  2. 文字数が短い順にソート
  3. 最大10件まで返却
- **データソース**: `src/data/pokemon.json`（PokeAPIから取得した最新のポケモンデータ）

### データ取得スクリプト

`fetch-pokemon.mjs`の特徴：

- **動的総数取得**: PokeAPIから最新のポケモン総数を自動取得するため、今後ポケモンが増えても自動的に対応
- **差分取得機能**: 既存の`pokemon.json`と比較し、新しいポケモンのみを取得
  - 初回実行: 全ポケモンを取得
  - 2回目以降: 既存データと差分がある分のみ取得（大幅に高速化）
  - 既存データが最新の場合: 取得をスキップ
- **APIマナー**: 各リクエストの間に0.1秒の待機時間を設け、APIサーバーへの負荷を軽減し、レート制限を回避

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 参考リンク

- [PokeAPI](https://pokeapi.co/) - ポケモンデータの提供元
- [Next.js Documentation](https://nextjs.org/docs)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)

